---
title: 'CVE-2025-38001'
date: 2025-12-25
permalink: /posts/2025/12/25/cve-2025-38001/
tags:
- veille-cyber
- intruder
---
### Blocage et déni de service dans le noyau Linux via HFSC

Une vulnérabilité critique, identifiée comme CVE-2025-38001, affecte le composant planificateur Hierarchical Fair Service Curve (HFSC) du noyau Linux. Cette faille, rendue publique le 6 juin 2025, permet un état de "use-after-free" (UAF) lorsque HFSC est utilisé conjointement avec NETEM.

Le problème découle d'une contournement d'un correctif antérieur visant à résoudre des problèmes d'insertion réentrante. Le patch initial ne vérifiait que le champ `cl->cl_nactive` pour déterminer la première insertion. Cependant, ce champ n'est incrémenté que par `init_vf`. L'utilisation de `HFSC_RSC` (qui utilise `inited`) permet de contourner cette vérification, autorisant une insertion double de la classe dans l'`eltree`.

Dans des conditions normales, cela peut engendrer une boucle infinie dans `hfsc_dequeue`. Toutefois, en combinaison avec une configuration de `TBF` comme qdisc racine avec un débit très faible, la vulnérabilité peut empêcher la sortie des paquets. Ceci permet des insertions ultérieures dans l'`eltree` HFSC, conduisant à un état UAF.

**Points clés :**
*   Vulnérabilité de type "use-after-free" (UAF).
*   Affecte le planificateur HFSC du noyau Linux.
*   Se manifeste lors de l'utilisation de HFSC avec NETEM.
*   Résulte d'un contournement d'un correctif précédent.

**Vulnérabilités :**
*   CVE-2025-38001 : Use-after-free dans HFSC lors de l'utilisation avec NETEM, causé par un contournement de patch sur l'insertion réentrante.

**Recommandations :**
*   Appliquer les correctifs du noyau Linux dès leur disponibilité pour corriger la CVE-2025-38001.
*   Envisager de limiter l'utilisation de NETEM avec HFSC, ou de revoir les configurations critiques de débit pour atténuer le risque, en attendant le correctif.

---
[Source](https://cvemon.intruder.io/cves/CVE-2025-38001){:target="_blank"}
