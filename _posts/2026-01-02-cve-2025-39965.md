---
title: 'CVE-2025-39965'
date: 2026-01-02
permalink: /posts/2026/01/02/cve-2025-39965/
tags:
- veille-cyber
- intruder
---
**Vulnerability in Linux Kernel XFRM Subsystem**

Une vulnérabilité de type use-after-free (UAF) a été identifiée dans le sous-système XFRM du noyau Linux, responsable de la mise en œuvre du protocole IPsec. Cette faille, référencée sous CVE-2025-39965, concerne la fonction `xfrm_alloc_spi`.

**Points Clés :**

*   La vulnérabilité survient lors de l'allocation d'un Security Parameter Index (SPI) via le message Netlink `XFRM_MSG_ALLOCSPI`.
*   Une modification récente de la logique d'allocation pour éviter la duplication des SPI a introduit le problème.
*   La fonction `get_random_u32_inclusive` peut retourner 0, une valeur non gérée par `xfrm_alloc_spi`.
*   Cela peut entraîner l'allocation d'un objet `xfrm_state` avec un SPI de 0 et son ajout à la liste globale `byspi`.
*   L'absence de suppression correcte de ces objets de la liste `byspi` lors du nettoyage laisse un pointeur pendant, causant une condition use-after-free.

**Vulnérabilité :**

*   **CVE :** CVE-2025-39965
*   **Type :** Use-after-free (UAF)
*   **Composant affecté :** Sous-système XFRM du noyau Linux (`net/xfrm/xfrm_state.c`, fonction `xfrm_alloc_spi`)

**Recommandations :**

L'article ne détaille pas explicitement les recommandations de correction, mais la nature de la vulnérabilité suggère qu'une mise à jour du noyau Linux est nécessaire pour corriger la gestion des SPIs de valeur 0 dans la fonction `xfrm_alloc_spi` et assurer leur retrait correct de la liste `byspi`.

---
[Source](https://cvemon.intruder.io/cves/CVE-2025-39965){:target="_blank"}
