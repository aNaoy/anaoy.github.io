---
title: 'CVE-2025-29970'
date: 2025-12-24
permalink: /posts/2025/12/24/cve-2025-29970/
tags:
- veille-cyber
- intruder
---
**Vulnérabilité dans le pilote Brokering File System de Microsoft**

Une faille de sécurité critique, identifiée sous le nom de CVE-2025-29970, a été découverte dans le pilote Brokering File System (BFS) de Microsoft, affectant plus précisément le composant bfs.sys. Cette vulnérabilité de type "use-after-free" découle d'une gestion inadéquate de la mémoire au sein de la logique de désallocation de la liste de blocs de répertoire (DirectoryBlockList) du BFS. Le problème survient lorsque le pointeur tête d'une liste chaînée est libéré prématurément, mais que la fonction continue d'accéder à cette mémoire déjà libérée lors d'itérations ultérieures. Ce scénario se manifeste dans la fonction BfsCloseStorage lors de la suppression de politiques via l'appel d'IOCTL BfsProcessDeletePolicyRequest.

L'exploitation de cette faille permettrait à un attaquant disposant d'un accès local et des privilèges appropriés d'obtenir une élévation de privilèges sur un système Windows. Pour réussir son attaque, l'attaquant doit se faire passer pour un processus possédant un jeton AppSilo et créer des entrées de politique dans le système. Cette vulnérabilité impacte particulièrement les systèmes utilisant les fonctionnalités de sandbox de Windows, notamment ceux qui déploient des applications isolées.

**Points Clés :**

*   **Type de vulnérabilité :** Use-after-free.
*   **Composant affecté :** Pilote Microsoft Brokering File System (BFS), spécifiquement bfs.sys.
*   **Cause :** Mauvaise gestion de la mémoire dans la désallocation de la liste chaînée DirectoryBlockList.
*   **Impact :** Élévation de privilèges sur un système Windows.
*   **Conditions d'exploitation :** Accès local, usurpation de processus avec un jeton AppSilo, création de politiques.
*   **Systèmes concernés :** Systèmes Windows utilisant les fonctionnalités de sandbox et déployant des applications isolées.

**Vulnérabilité :**

*   **CVE-2025-29970**

**Recommandations :**

Bien que l'article ne fournisse pas de recommandations spécifiques, les vulnérabilités de ce type appellent généralement aux actions suivantes :

*   **Mise à jour du système :** Appliquer rapidement les correctifs de sécurité fournis par Microsoft pour le pilote BFS.
*   **Surveillance des accès :** Renforcer la surveillance des accès et des tentatives d'élévation de privilèges sur les systèmes potentiellement vulnérables.
*   **Gestion des politiques :** Examiner et restreindre les permissions liées à la gestion des politiques sur les systèmes sensibles.

---
[Source](https://cvemon.intruder.io/cves/CVE-2025-29970){:target="_blank"}
